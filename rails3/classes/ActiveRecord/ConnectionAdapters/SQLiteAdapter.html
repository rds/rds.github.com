<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: ActiveRecord::ConnectionAdapters::SQLiteAdapter [Rails Framework Documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          ActiveRecord::ConnectionAdapters::SQLiteAdapter
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../files/vendor/gems/gems/activerecord-3_0_0_beta/lib/active_record/connection_adapters/sqlite_adapter_rb.html">vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a href="AbstractAdapter.html">ActiveRecord::ConnectionAdapters::AbstractAdapter</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            The SQLite adapter works with both the 2.x and 3.x series of SQLite with
            the sqlite-ruby drivers (available both as gems and from <a
            href="http://rubyforge.org/projects/sqlite-ruby">rubyforge.org/projects/sqlite-ruby</a>/).
            </p>
            <p>
            Options:
            </p>
            <ul>
            <li><tt>:database</tt> - Path to the database file.
            
            </li>
            </ul>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M001042">new</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M001050">change_column_null</a></li>
              <li><a href="#M001046">disconnect!</a></li>
              <li><a href="#M001051">empty_insert_statement_value</a></li>
              <li><a href="#M001048">rename_table</a></li>
              <li><a href="#M001044">requires_reloading?</a></li>
              <li><a href="#M001047">select_rows</a></li>
              <li><a href="#M001045">supports_add_column?</a></li>
              <li><a href="#M001043">supports_ddl_transactions?</a></li>
              <li><a href="#M001049">valid_alter_table_options</a></li>
            </ol>
            <h3>protected instance</h3>
            <ol>
              <li><a href="#M001053">catch_schema_changes</a></li>
              <li><a href="#M001055">default_primary_key_type</a></li>
              <li><a href="#M001054">sqlite_version</a></li>
              <li><a href="#M001052">table_structure</a></li>
              <li><a href="#M001056">translate_exception</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='class-list'>
              <h2>Classes and Modules</h2>
              Class <a href="SQLiteAdapter/Version.html" class="link">ActiveRecord::ConnectionAdapters::SQLiteAdapter::Version</a><br />
            </div>
            <div id='aliases-list'>
              <h2>External Aliases</h2>
              <div class='name-list'>
                <table summary='External aliases'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>insert_sql</td>
                    <td>-&gt;</td>
                    <td class='context-item-value'>create</td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>remove_column</td>
                    <td>-&gt;</td>
                    <td class='context-item-value'>remove_columns</td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='method public-class' id='method-M001042'>
                <a name='M001042'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(connection, logger, config)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001042-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001042-source'>    <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 66</span>&#x000A;66:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">logger</span>, <span class="ruby-identifier">config</span>)&#x000A;67:         <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">logger</span>)&#x000A;68:         <span class="ruby-ivar">@config</span> = <span class="ruby-identifier">config</span>&#x000A;69:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M001050'>
                <a name='M001050'></a>
                <div class='synopsis'>
                  <span class='name'>change_column_null</span>
                  <span class='arguments'>(table_name, column_name, null, default = nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001050-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001050-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 260</span>&#x000A;260:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_column_null</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">null</span>, <span class="ruby-identifier">default</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;261:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">null</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">default</span>.<span class="ruby-identifier">nil?</span>&#x000A;262:           <span class="ruby-identifier">execute</span>(<span class="ruby-node">&quot;UPDATE #{quote_table_name(table_name)} SET #{quote_column_name(column_name)}=#{quote(default)} WHERE #{quote_column_name(column_name)} IS NULL&quot;</span>)&#x000A;263:         <span class="ruby-keyword kw">end</span>&#x000A;264:         <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">table_name</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">definition</span><span class="ruby-operator">|</span>&#x000A;265:           <span class="ruby-identifier">definition</span>[<span class="ruby-identifier">column_name</span>].<span class="ruby-identifier">null</span> = <span class="ruby-identifier">null</span>&#x000A;266:         <span class="ruby-keyword kw">end</span>&#x000A;267:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M001046'>
                <a name='M001046'></a>
                <div class='synopsis'>
                  <span class='name'>disconnect!</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001046-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001046-source'>    <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 95</span>&#x000A;95:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disconnect!</span>&#x000A;96:         <span class="ruby-keyword kw">super</span>&#x000A;97:         <span class="ruby-ivar">@connection</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>&#x000A;98:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M001051'>
                <a name='M001051'></a>
                <div class='synopsis'>
                  <span class='name'>empty_insert_statement_value</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001051-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001051-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 288</span>&#x000A;288:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty_insert_statement_value</span>&#x000A;289:         <span class="ruby-value str">&quot;VALUES(NULL)&quot;</span>&#x000A;290:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M001048'>
                <a name='M001048'></a>
                <div class='synopsis'>
                  <span class='name'>rename_table</span>
                  <span class='arguments'>(name, new_name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001048-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001048-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 225</span>&#x000A;225:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rename_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">new_name</span>)&#x000A;226:         <span class="ruby-identifier">execute</span> <span class="ruby-node">&quot;ALTER TABLE #{quote_table_name(name)} RENAME TO #{quote_table_name(new_name)}&quot;</span>&#x000A;227:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M001044'>
                <a name='M001044'></a>
                <div class='synopsis'>
                  <span class='name'>requires_reloading?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001044-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001044-source'>    <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 87</span>&#x000A;87:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">requires_reloading?</span>&#x000A;88:         <span class="ruby-keyword kw">true</span>&#x000A;89:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M001047'>
                <a name='M001047'></a>
                <div class='synopsis'>
                  <span class='name'>select_rows</span>
                  <span class='arguments'>(sql, name = nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001047-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001047-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 168</span>&#x000A;168:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_rows</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;169:         <span class="ruby-identifier">execute</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>&#x000A;170:           (<span class="ruby-value">0</span><span class="ruby-operator">...</span>(<span class="ruby-identifier">row</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">/</span> <span class="ruby-value">2</span>)).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">row</span>[<span class="ruby-identifier">i</span>] }&#x000A;171:         <span class="ruby-keyword kw">end</span>&#x000A;172:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M001045'>
                <a name='M001045'></a>
                <div class='synopsis'>
                  <span class='name'>supports_add_column?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001045-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001045-source'>    <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 91</span>&#x000A;91:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">supports_add_column?</span>&#x000A;92:         <span class="ruby-identifier">sqlite_version</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value str">'3.1.6'</span>&#x000A;93:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M001043'>
                <a name='M001043'></a>
                <div class='synopsis'>
                  <span class='name'>supports_ddl_transactions?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001043-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001043-source'>    <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 75</span>&#x000A;75:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">supports_ddl_transactions?</span>&#x000A;76:         <span class="ruby-identifier">sqlite_version</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value str">'2.0.0'</span>&#x000A;77:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M001049'>
                <a name='M001049'></a>
                <div class='synopsis'>
                  <span class='name'>valid_alter_table_options</span>
                  <span class='arguments'>( type, options)</span>
                </div>
                <div class='description'>
                  <p>
                  See: <a
                  href="http://www.sqlite.org/lang_altertable.html">www.sqlite.org/lang_altertable.html</a>
                  SQLite has an additional restriction on the ALTER TABLE statement
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001049-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001049-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 231</span>&#x000A;231:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">valid_alter_table_options</span>( <span class="ruby-identifier">type</span>, <span class="ruby-identifier">options</span>)&#x000A;232:         <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">:primary_key</span>&#x000A;233:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Protected instance methods</h2>
              <div class='method protected-instance' id='method-M001053'>
                <a name='M001053'></a>
                <div class='synopsis'>
                  <span class='name'>catch_schema_changes</span>
                  <span class='arguments'>() {|| ...}</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001053-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001053-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 390</span>&#x000A;390:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">catch_schema_changes</span>&#x000A;391:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">yield</span>&#x000A;392:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">StatementInvalid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">exception</span>&#x000A;393:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">exception</span>.<span class="ruby-identifier">message</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/database schema has changed/</span>&#x000A;394:             <span class="ruby-identifier">reconnect!</span>&#x000A;395:             <span class="ruby-keyword kw">retry</span>&#x000A;396:           <span class="ruby-keyword kw">else</span>&#x000A;397:             <span class="ruby-identifier">raise</span>&#x000A;398:           <span class="ruby-keyword kw">end</span>&#x000A;399:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-M001055'>
                <a name='M001055'></a>
                <div class='synopsis'>
                  <span class='name'>default_primary_key_type</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001055-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001055-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 405</span>&#x000A;405:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_primary_key_type</span>&#x000A;406:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">supports_autoincrement?</span>&#x000A;407:             <span class="ruby-value str">'INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL'</span>.<span class="ruby-identifier">freeze</span>&#x000A;408:           <span class="ruby-keyword kw">else</span>&#x000A;409:             <span class="ruby-value str">'INTEGER PRIMARY KEY NOT NULL'</span>.<span class="ruby-identifier">freeze</span>&#x000A;410:           <span class="ruby-keyword kw">end</span>&#x000A;411:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-M001054'>
                <a name='M001054'></a>
                <div class='synopsis'>
                  <span class='name'>sqlite_version</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001054-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001054-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 401</span>&#x000A;401:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sqlite_version</span>&#x000A;402:           <span class="ruby-ivar">@sqlite_version</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">SQLiteAdapter</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'select sqlite_version(*)'</span>))&#x000A;403:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-M001052'>
                <a name='M001052'></a>
                <div class='synopsis'>
                  <span class='name'>table_structure</span>
                  <span class='arguments'>(table_name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001052-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001052-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 305</span>&#x000A;305:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">table_structure</span>(<span class="ruby-identifier">table_name</span>)&#x000A;306:           <span class="ruby-identifier">structure</span> = <span class="ruby-ivar">@connection</span>.<span class="ruby-identifier">table_info</span>(<span class="ruby-identifier">quote_table_name</span>(<span class="ruby-identifier">table_name</span>))&#x000A;307:           <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">StatementInvalid</span>, <span class="ruby-node">&quot;Could not find table '#{table_name}'&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">structure</span>.<span class="ruby-identifier">empty?</span>&#x000A;308:           <span class="ruby-identifier">structure</span>&#x000A;309:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-M001056'>
                <a name='M001056'></a>
                <div class='synopsis'>
                  <span class='name'>translate_exception</span>
                  <span class='arguments'>(exception, message)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M001056-source'); return false">
                    [show source]
                  </a>
                  <pre id='M001056-source'>     <span class="ruby-comment cmt"># File vendor/gems/gems/activerecord-3.0.0.beta/lib/active_record/connection_adapters/sqlite_adapter.rb, line 413</span>&#x000A;413:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">translate_exception</span>(<span class="ruby-identifier">exception</span>, <span class="ruby-identifier">message</span>)&#x000A;414:           <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">exception</span>.<span class="ruby-identifier">message</span>&#x000A;415:           <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/column(s)? .* (is|are) not unique/</span>&#x000A;416:             <span class="ruby-constant">RecordNotUnique</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">message</span>, <span class="ruby-identifier">exception</span>)&#x000A;417:           <span class="ruby-keyword kw">else</span>&#x000A;418:             <span class="ruby-keyword kw">super</span>&#x000A;419:           <span class="ruby-keyword kw">end</span>&#x000A;420:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
